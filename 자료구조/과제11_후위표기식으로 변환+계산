#include <iostream>
using namespace std;

//Ω∫≈√¿ª ¿ÃøÎ«— »ƒ¿ß«•±‚∑Œ ∫Ø»Ø + ∞ËªÍ

#define element int
const int MAX_SIZE = 1000;

class Stack {
public:

	char mystack[MAX_SIZE]; //πËø≠∑Œ ±∏«ˆ
	int top; //√ ±‚»≠

	Stack() { top = -1; }

	bool is_stack_empty() {
		return(top == -1); //«—¡Ÿ∑Œ ±∏«ˆ∞°¥… 
	}

	bool is_stack_full() {
		return(top == MAX_SIZE - 1);
	}

	void push(element data) {
		if (is_stack_full()) {
			cout << "ERROR: Stack Full" << endl;
			return;
		}
		else {
			mystack[++top] = data;
		}
	}

	char pop() {
		if (is_stack_empty()) {
			cout << "ERROR: Stack Empty" << endl;
			return -1;
		}
		else {
			return mystack[top--];
		}
	}

	void print_stack() {
		//cout << "STACK STATUS" << endl;

		for (int i = top; i >= 0; i--)
			cout << mystack[i] << endl;
	}
};


char post_fix_expr[1000];
int p_index = 0;

char *postfix(char expr[]) {
	Stack MyStack;

	//convert to postfix *∞°¡§ º“∞˝»£∏∏, ªÁ¡˜ø¨ªÍ, ««ø¨ªÍ¿⁄¥¬ «—¿⁄∏Æ
	for (int i = 0; i < strlen(expr); i++) {
		if (expr[i]=='(') { //øﬁ¬  ∞˝»£∏È
			continue;
		}
		else if (expr[i] == '+' || expr[i] == '-'|| expr[i] == '*' || expr[i] == '/') { //ø¨¿‹ªÁ∏È
			MyStack.push(expr[i]);
		}
		else if (expr[i] == ')') { //ø¿∏•¬  ∞˝»£∏È
			//cout << MyStack.pop();
			post_fix_expr[p_index++] = MyStack.pop();
		}
		else if (expr[i] == ' ') {
			continue;
		}
		else { //««ø¨ªÍ¿⁄∏È
			//cout << expr[i];
			post_fix_expr[p_index++] = expr[i];
		}
	}
	
	//cout << endl;
	post_fix_expr[p_index] = NULL;
	return post_fix_expr;
}


int calculate(char postfix[]) {
	Stack MyStack;

	for (int i = 0; i < strlen(postfix); i++) {
		//ø¨ªÍ¿⁄∏È pop»ƒ ∞ËªÍ, ∞ËªÍ ∞·∞˙¥¬ ¥ŸΩ√ Ω∫≈√ø° push
		if (postfix[i] == '+') {
			int opr1 = MyStack.pop();
			int opr2 = MyStack.pop();
			MyStack.push(opr1 + opr2);

		}
		else if (postfix[i] == '*') {
			int opr1 = MyStack.pop();
			int opr2 = MyStack.pop();
			MyStack.push(opr1 * opr2);
		}
		else if (postfix[i] == '-') {
			int opr2 = MyStack.pop();
			int opr1 = MyStack.pop();
			MyStack.push(opr1 - opr2);
		}
		else if (postfix[i] == '/') {
			int opr2 = MyStack.pop();
			int opr1 = MyStack.pop();
			MyStack.push(opr1 / opr2);
		}
		else if (postfix[i] >= '0' && postfix[i] <= '9') {//««ø¨ªÍ¿⁄∏È Ω∫≈√ø° push
			
			MyStack.push(postfix[i] - '0'); //πÆ¿⁄∏¶ º˝¿⁄∑Œ ∫Ø»Ø
		}
	
	}
	//√÷¡æ∞·∞˙¥¬ Ω∫≈√ø° ≥≤æ∆ ¿÷¥¬ ∞™¿ª pop«œø© ∫Ø»Ø
	return MyStack.pop();
}


void main() {
	char string[100];
	cout << "¡ﬂ¿ß«•±‚ ºˆΩƒ¿ª ¿‘∑¬«œººø‰: ";
	cin.getline( string,100);

	char *post_expr = postfix(string);
	//cout << string << " ===> " << post_expr << endl;

	cout << string << " = " << post_expr << " = " << calculate(post_expr) << endl;

}
